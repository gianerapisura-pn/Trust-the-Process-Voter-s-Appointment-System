<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Trust the Process: Voter’s Appointment System</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>

<header class="header">
  <div class="logo-section">
    <img src="mylogo.png" alt="Logo" class="logo">
    <h1>TRUST THE PROCESS: VOTER’S APPOINTMENT SYSTEM</h1>
  </div>
</header>

<div class="text-center mt-3">
  <a href="appointment.html" class="nav-btn"><i class="fa-solid fa-calendar-days"></i> Schedule an Appointment</a>
  <a href="manage_appointment.html" class="nav-btn"><i class="fa-regular fa-clock"></i> Manage my Appointment</a>
  <a href="requirements.html" class="nav-btn"><i class="fa-solid fa-clipboard-list"></i> List of Requirements</a>
</div>

<div class="form-section">
  <h4><strong>Schedule an Appointment</strong></h4>
  <div class="section-header">PERSONAL INFORMATION</div>

  <form id="personalForm">
    <div class="row mb-3">
      <div class="col-md-4">
        <label for="lastName" class="form-label">Last Name *</label>
        <input type="text" class="form-control" id="lastName" placeholder="Last Name" required>
      </div>
      <div class="col-md-4">
        <label for="firstName" class="form-label">First Name *</label>
        <input type="text" class="form-control" id="firstName" placeholder="First Name" required>
      </div>
      <div class="col-md-4">
        <label class="form-label">&nbsp;</label>
        <input type="text" class="form-control" id="middleName" placeholder="Middle Name (Optional)">
      </div>
    </div>

    <div class="row mb-4">
      <div class="col-md-6">
        <label for="suffix" class="form-label">Suffix (Optional)</label>
        <input type="text" class="form-control" id="suffix">
      </div>
      <div class="col-md-6">
        <label for="birthday" class="form-label">Birthday *</label>
        <input type="date" class="form-control" id="birthday" required>
      </div>
    </div>

    <div class="text-center">
      <a href="index.html" class="btn-action text-decoration-none text-white">BACK</a>
      <button type="submit" class="btn-action">CONTINUE</button>
    </div>
  </form>
</div>

<footer>
  <div class="footer-section">
    <div>
      <strong>TRUST THE PROCESS: VOTER’S APPOINTMENT SYSTEM</strong><br>
      123 Mabini Street, Barangay San Isidro, Quezon City, Metro Manila,<br>
      1103, Philippines
    </div>
    <div>
      <strong>CONTACT US</strong><br>
      vas.concerns@ttp.gov.ph<br>
      (02) 1234 - 5678
    </div>
    <div>
      <strong>SITEMAP</strong><br>
      <a href="index.html">HOME</a><br>
      <a href="#">REQUIREMENTS</a><br>
      <a href="appointment.html">SCHEDULE AN APPOINTMENT</a>
    </div>
  </div>
</footer>

<script src="api.js"></script>
<script src="voters.js"></script>
<script>
document.getElementById('personalForm').addEventListener('submit', async function(event) {
  event.preventDefault();

  const data = {
    first_name: document.getElementById('firstName').value.trim(),
    last_name: document.getElementById('lastName').value.trim(),
    middle_name: document.getElementById('middleName').value.trim(),
    suffix: document.getElementById('suffix').value.trim(),
    birthday: document.getElementById('birthday').value,
    slot_id: 1 // default slot
  };

  if (!data.first_name || !data.last_name || !data.birthday) {
    alert('⚠️ Please fill in all required fields before continuing.');
    return;
  }

  console.log('Submitting data:', data);

  try {
    const response = await submitVoterForm(data);
    console.log('Response from backend:', response);
    localStorage.setItem('currentVoter', JSON.stringify(response));
    window.location.href = "gender_and_address.html";
  } catch (err) {
    alert('Failed to save data. Please try again.');
    console.error(err);
  }
});
</script>

</body>
</html>
